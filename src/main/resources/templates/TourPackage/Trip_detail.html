<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>Trip Detail</title>
    <!-- plugins:css -->
    <link rel="stylesheet" href="../../assets/vendors/mdi/css/materialdesignicons.min.css">
    <link rel="stylesheet" href="../../assets/vendors/css/vendor.bundle.base.css">
    <!-- endinject -->
    <!-- Plugin css for this page -->
    <!-- End plugin css for this page -->
    <!-- inject:css -->
    <!-- endinject -->
    <!-- Layout styles -->
    <link rel="stylesheet" href="../../assets/css/style.css">
    <!-- End layout styles -->
    <link rel="shortcut icon" href="../../assets/images/favicon.ico"/>

    <!-- Css Styles -->
    <link th:href="@{/css/mainpage/bootstrap.min.css}" rel="stylesheet" type="text/css"/>
    <link th:href="@{/css/mainpage/style.css}" rel="stylesheet" type="text/css"/>

    <style>
        body {
            min-width: 1000px;
        }

        #trip_checkbox {
            text-align: center;
            padding-left:15px;
            padding-right: 15px;
            flex-wrap: wrap;
            flex: 0 0 35%;
            min-width: 306px;
            right: 0px;
            display: inline-block;
            min-height: 400px;
            max-height: 600px;
            overflow: hidden;
        }

        #small_IMG {
            /*flex: 0 0 calc(15% - 10px);
            max-width: calc(15% - 10px);
            position: relative;
            width: calc(100% - 20px);*/
            padding-right: 15px;
            padding-left: 15px;
            display: inline-block;
        }

        #big_IMG {
            /*flex: 0 0 calc(50% - 10px);
            max-width: calc(50% - 10px);
            position: relative;
            width: calc(100% - 20px);*/
            padding-right: 15px;
            padding-left: 15px;
            display: inline-block;
      /*      margin-right: 20px;*/
        }

        #big_IMG .row {
            margin-top: 10px;
            padding-top: 25px;
            border: 1px black solid;
            border-radius: 30px;
            background: #f3f2ee;
        }

        #big_IMG img {
         /*   min-width: 470px;*/
        }

        .product__details__pic__item {
        }

        .cart__total .trip-btn, .trip-btn {
            display: block;
            padding: 10px 8px;
            text-align: center;
            letter-spacing: 2px;
        }

        .trip-btn {
            display: inline-block;
            font-size: 13px;
            font-weight: 700;
            text-transform: uppercase;
            padding: 14px 30px;
            color: #ffffff;
            background: #ffdb99;
            letter-spacing: 4px;
        }

        #cart-btn {
            display: table;
            table-layout: fixed;
            width: 100%;
        }

        .cart-btn-detail1 {
            text-align: center;
            display: table-cell;
            padding: 2px;
            vertical-align: top;
            width: 150px;
            height: 44px;
        }

        .cart-btn-detail2 {
            text-align: center;
            display: table-cell;
            padding: 2px;
            vertical-align: top;
            width: 150px;
            height: 44px;
        }

        .multiselect {
            width: 220px;
            margin: 0 auto;
        }

        .selectBox {
            position: relative;
        }

        .selectBox select {
            width: 100%;
            font-weight: bold;
        }

        .overSelect {
            position: absolute;
            left: 0;
            right: 0;
            top: 0;
            bottom: 0;
        }

        #checkboxes {
            text-align: left;
            display: none;
            border: 1px #dadada solid;
            width: 220px;
            background: white;
            box-shadow: 0.5px 0.5px 1px 0.5px #dadce0;
        }

        #checkboxes label {
            display: block;
            padding-left: 5px;
            padding-right: 5px;
            padding-bottom: 4px;
            padding-top: 4px;
            margin: 0px;
            border-bottom: 0.5px solid rgba(0, 0, 0, 0.3);
        }

        #checkboxes label:hover {
            background-color: #1e90ff;
        }

        .option_sample {
            background-color: white;
        }

        .product__details__pic .nav-tabs .nav-item .nav-link .product__thumb__pic {
            min-width: 95px;
        }

        .nav-tabs .nav-link.active{
            background-color:#edf3f3;
            border : #edf3f3;
        }

        .checkout__total__all li span{
            float: none;
        }


    </style>
</head>
<body>
<div class="container-scroller">
    <!-- partial:../../partials/_navbar.html -->
  <th:block th:replace="~{TripHSF/_navbar :: navbar}"></th:block>
    <!-- partial -->
    <div class="container-fluid page-body-wrapper">
        <!-- partial:../../partials/_sidebar.html -->
       <th:block th:replace="~{TripHSF/_sidebar :: sidebar}"></th:block>

        <!-- partial -->
        <div class="main-panel">
            <div class="content-wrapper">
                <!-- Shop Details Section Begin -->
                <section class="shop-details">
                        <div class="container">
                            <div class="row">
                                <div class="col-lg-2 col-md-2 col-sm-2" id="small_IMG">
                                    <ul class="nav nav-tabs" role="tablist">
                                        <li class="nav-item">
                                            <a class="nav-link active" data-toggle="tab" href="#tabs-1" role="tab">
                                                <div class="product__thumb__pic set-bg">
                                                    <img th:src="@{${tripFile.mainIMG}}" alt="Main Image">
                                                </div>
                                            </a>
                                        </li>
                                        <li class="nav-item">
                                            <a class="nav-link" data-toggle="tab" href="#tabs-2" role="tab">
                                                <div class="product__thumb__pic set-bg">
                                                    <img th:src="@{${tripFile.introIMG}}" alt="Intro Image">
                                                </div>
                                            </a>
                                        </li>
                                        <li class="nav-item">
                                            <a class="nav-link" data-toggle="tab" href="#tabs-3" role="tab">
                                                <div class="product__thumb__pic set-bg">
                                                    <img th:src="@{${tripFile.routeIMG}}" alt="Route Image">
                                                </div>
                                            </a>
                                        </li>
                                        <li class="nav-item">
                                            <a class="nav-link" data-toggle="tab" href="#tabs-4" role="tab">
                                                <div class="product__thumb__pic set-bg">
                                                    <img th:src="@{${tripFile.scheduleIMG}}" alt="Schedule Image">
                                                </div>
                                            </a>
                                        </li>
                                        <li class="nav-item">
                                            <a class="nav-link" data-toggle="tab" href="#tabs-5" role="tab">
                                                <div class="product__thumb__pic set-bg">
                                                    <img th:src="@{${tripFile.detailIMG}}" alt="Detail Image">
                                                </div>
                                            </a>
                                        </li>
                                    </ul>
                                </div>

                                <div class="col-lg-5 col-md-5 col-sm-5" id="big_IMG">
                                    <div class="tab-content">
                                        <div class="tab-pane active" id="tabs-1" role="tabpanel">
                                            <div class="product__details__pic__item">
                                                <img th:src="@{${tripFile.mainIMG}}" alt="Main Image">
                                            </div>
                                        </div>
                                        <div class="tab-pane" id="tabs-2" role="tabpanel">
                                            <div class="product__details__pic__item">
                                                <img th:src="@{${tripFile.introIMG}}" alt="Intro Image">
                                            </div>
                                        </div>
                                        <div class="tab-pane" id="tabs-3" role="tabpanel">
                                            <div class="product__details__pic__item">
                                                <img th:src="@{${tripFile.routeIMG}}" alt="Route Image">
                                            </div>
                                        </div>
                                        <div class="tab-pane" id="tabs-4" role="tabpanel">
                                            <div class="product__details__pic__item">
                                                <img th:src="@{${tripFile.scheduleIMG}}" alt="Schedule Image">
                                            </div>
                                        </div>
                                        <div class="tab-pane" id="tabs-5" role="tabpanel">
                                            <div class="product__details__pic__item">
                                                <img th:src="@{${tripFile.detailIMG}}" alt="Detail Image">
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="col-lg-5 col-md-5 col-sm-5" id="trip_checkbox">
                                    <div class="checkout__order">
                                        <h4 class="order__title" th:text="${trip.tripName}"></h4>
                                        <h4 class="order__title">[<span th:text="${#strings.substring(trip.tripDate, 2, 4)} + '년' + ${#strings.substring(trip.tripDate, 5, 7)} + '월'+${#strings.substring(trip.tripDate, 8)} + '일 '+ '출발'"></span>
                                            ]</h4>
                                        <ul class="checkout__total__products">
                                            <div class="multiselect">
                                                <div class="selectBox" onclick="showCheckboxes()">
                                                    <select>
                                                        <option>옵션 선택</option>
                                                    </select>
                                                    <div class="overSelect"></div>
                                                </div>
                                                <div id="checkboxes">
                                                    <div th:each="opt, status : ${options}">
                                                        <label th:for="'product' + ${status.index}">
                                                            <input type="checkbox" th:id="'product' + ${status.index}" th:data-price="${opt.optionPrice}" th:data-optionName="${opt.optionId}" onclick="calculateTotal()"/>
                                                            <span th:text="${opt.optionName + ' (+₩' + opt.optionPrice div 10000 + '만)'}"></span>
                                                        </label>
                                                    </div>
                                                </div>
                                            </div>
                                        </ul>
                                        <ul class="checkout__total__all">
                                            <li>Option Price: ₩<span id="totalPrice">0</span></li>
                                        </ul>

                                        <div class="cart-btn">
                                            <div class="cart-btn-detail1"><a href="#" class="site-btn">찜하기</a></div>
                                            <div class="cart-btn-detail2"><a href="#" class="site-btn" id="Cart-btn" onclick="redirectToCart()">구매하기</a></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                </section>
                <!-- Shop Details Section End -->

            </div>
            <!-- content-wrapper ends -->
            <!-- partial:../../partials/_footer.html -->
            <footer class="footer">
                <div class="container-fluid d-flex justify-content-between">
                    <span class="text-muted d-block text-center text-sm-start d-sm-inline-block">Copyright © bootstrapdash.com 2021</span>
                    <span class="float-none float-sm-end mt-1 mt-sm-0 text-end"> Free <a
                            href="https://www.bootstrapdash.com/bootstrap-admin-template/" target="_blank">Bootstrap admin template</a> from Bootstrapdash.com</span>
                </div>
            </footer>
            <!-- partial -->
        </div>
        <!-- main-panel ends -->
    </div>
    <!-- page-body-wrapper ends -->
</div>
<!-- container-scroller -->
<!-- plugins:js -->
<script src="../../assets/vendors/js/vendor.bundle.base.js"></script>
<!-- endinject -->
<!-- Plugin js for this page -->
<!-- End plugin js for this page -->
<!-- inject:js -->
<script src="../../assets/js/off-canvas.js"></script>
<script src="../../assets/js/hoverable-collapse.js"></script>
<script src="../../assets/js/misc.js"></script>
<!-- endinject -->
<!-- Custom js for this page -->
<!-- End custom js for this page -->

<!-- Js Plugins -->
<script src="/js/mainpage/jquery-3.3.1.min.js"></script>
<script src="/js/mainpage/bootstrap.min.js"></script>
<!--<script src="js/mainpage/jquery.nicescroll.min.js"></script>-->
<!--<script src="js/mainpage/jquery.countdown.min.js"></script>-->
<!-- <script src="js/mainpage/mixitup.min.js"></script>-->
<script src="/js/mainpage/main.js"></script>

<!-- 옵션버튼.js -->
<script th:inline="javascript">
    var expanded = false;

    function showCheckboxes() {
        var checkboxes = document.getElementById("checkboxes");
        if (!expanded) {
            checkboxes.style.display = "inline-block";
            expanded = true;
        } else {
            checkboxes.style.display = "none";
            expanded = false;
        }
    }

    var checkboxes = document.querySelectorAll('input[type="checkbox"]');
    checkboxes.forEach(function (checkbox) {
        checkbox.addEventListener('change', function () {
            calculateTotal();
        });
    });

    function calculateTotal() {
        var totalPrice = 0;
        checkboxes.forEach(function (checkbox) {
            if (checkbox.checked) {
                totalPrice += parseFloat(checkbox.getAttribute('data-price'));
            }
        });
        document.getElementById('totalPrice').textContent = totalPrice;
    }

    function redirectToCart() {
        var selectedOptions = [];

        checkboxes.forEach(function (checkbox) {
            if (checkbox.checked) {
                selectedOptions.push(checkbox.getAttribute('data-optionName'));
            }
        });

        var tripNo = /*[[${tripNo}]]*/ '0';
        var cartNo = /*[[${cartTripNo}]]*/ '0';
        var check = /*[[${check}]]*/ '0';
        console.log("tripNo ="+tripNo);
        console.log("cartNo ="+cartNo);
        console.log("check ="+check);

        var redirectURL = "tripCart?selectedOptions=" + selectedOptions.join("-")+"&num=" + tripNo;
        if (parseInt(check) === 1) {
            if (parseInt(tripNo) !== parseInt(cartNo)) {
                alert("장바구니를 비워주세요.");
                redirectURL = "tripDetail?num=" + tripNo;
            } else {
                redirectURL = "tripCart?selectedOptions=" + selectedOptions.join("-")+"&num=" + tripNo;
            }
        }

        window.location.href = redirectURL;
    }
</script>
<!-- 옵션버튼 -->
</body>
</html>