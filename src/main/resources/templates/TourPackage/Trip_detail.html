<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:c="http://java.sun.com/jsp/jstl/core"
      xmlns:fmt="http://java.sun.com/jsp/jstl/fmt">
<head>
    <meta charset="UTF-8"/>
    <meta name="description" content="Male_Fashion Template"/>
    <meta name="keywords" content="Male_Fashion, unica, creative, html"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <meta http-equiv="X-UA-Compatible" content="ie=edge"/>
    <title>상품 상세 페이지</title>

    <!-- Css Styles -->
    <link th:href="@{/css/mainpage/bootstrap.min.css}" rel="stylesheet" type="text/css"/>
    <link th:href="@{/css/mainpage/style.css}" rel="stylesheet" type="text/css"/>

    <style>
        body {
            min-width: 1000px;
        }

        #detail_page {
            background: white;
            padding-top: 100px;
            padding-bottom: 100px;
        }

        #trip_checkbox {
            display: flex;
            background: white;
            flex-wrap: wrap;
            flex: 0 0 35%;
            min-width: 306px;
            max-width: 35%;
            right: 20px;
            display: inline-block;
            min-height: 400px;
            max-height: 600px;
            overflow: hidden;
        }

        .small_IMG {
            flex: 0 0 calc(15% - 10px);
            max-width: calc(15% - 10px);
            position: relative;
            width: calc(100% - 20px);
            padding-right: 15px;
            padding-left: 15px;
            display: inline-block;
        }

        .big_IMG {
            flex: 0 0 calc(50% - 10px);
            max-width: calc(50% - 10px);
            position: relative;
            width: calc(100% - 20px);
            padding-right: 15px;
            padding-left: 15px;
            display: inline-block;
            margin-right: 20px;
        }

        .big_IMG .row {
            margin-top: 10px;
            padding-top: 25px;
            border: 1px black solid;
            border-radius: 30px;
            background: #f3f2ee;
        }

        .big_IMG img {
            min-width: 470px;
        }

        .product__details__pic__item {
        }

        .cart__total .trip-btn, .trip-btn {
            display: block;
            padding: 10px 8px;
            text-align: center;
            letter-spacing: 2px;
        }

        .trip-btn {
            display: inline-block;
            font-size: 13px;
            font-weight: 700;
            text-transform: uppercase;
            padding: 14px 30px;
            color: #ffffff;
            background: #ffdb99;
            letter-spacing: 4px;
        }

        #cart-btn {
            display: table;
            table-layout: fixed;
            width: 100%;
        }

        .cart-btn-detail1 {
            display: table-cell;
            padding: 2px;
            vertical-align: top;
            width: 150px;
            height: 44px;
        }

        .cart-btn-detail2 {
            display: table-cell;
            padding: 2px;
            vertical-align: top;
            width: 150px;
            height: 44px;
        }

        .multiselect {
            width: 220px;
            margin: 0 auto;
        }

        .selectBox {
            position: relative;
        }

        .selectBox select {
            width: 100%;
            font-weight: bold;
        }

        .overSelect {
            position: absolute;
            left: 0;
            right: 0;
            top: 0;
            bottom: 0;
        }

        #checkboxes {
            text-align: left;
            display: none;
            border: 1px #dadada solid;
            width: 220px;
            background: white;
            box-shadow: 0.5px 0.5px 1px 0.5px #dadce0;
        }

        #checkboxes label {
            display: block;
            padding-left: 5px;
            padding-right: 5px;
            padding-bottom: 4px;
            padding-top: 4px;
            margin: 0px;
            border-bottom: 0.5px solid rgba(0, 0, 0, 0.3);
        }

        #checkboxes label:hover {
            background-color: #1e90ff;
        }

        .option_sample {
            background-color: white;
        }

        .product__details__pic .nav-tabs .nav-item .nav-link .product__thumb__pic {
            min-width: 95px;
        }
    </style>
</head>

<body id="trip_body">
<!-- Page Preloder -->
<div id="preloder">
    <div class="loader"></div>
</div>

<!-- Header Section Begin -->
<!--
<c:if test="${empty member_id}">
    <jsp:include page="../mainpage/header.jsp"/>
</c:if>
<c:if test="${!empty member_id}">
    <jsp:include page="../member/memberHeader.jsp"/>
</c:if>
-->
<!-- Header Section End -->

<!-- Breadcrumb Section Begin -->
<section class="breadcrumb-option">
    <div class="container">
        <div class="row">
            <div class="col-lg-12">
                <div class="breadcrumb__text">
                    <h4>Shop</h4>
                    <div class="breadcrumb__links">
                        <a th:href="@{/index.html}">Home</a>
                        <span>Shop</span>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
<!-- Breadcrumb Section End -->

<!-- Shop Details Section Begin -->
<section class="shop-details">
    <div class="product__details__pic" id="detail_page">
        <div class="container">
            <div class="row">
                <div class="small_IMG">
                    <ul class="nav nav-tabs" role="tablist">
                        <li class="nav-item">
                            <a class="nav-link active" data-toggle="tab" href="#tabs-1" role="tab">
                                <div class="product__thumb__pic set-bg">
                                    <img th:src="@{${tripFile.mainIMG}}" alt="Main Image">
                                </div>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" data-toggle="tab" href="#tabs-2" role="tab">
                                <div class="product__thumb__pic set-bg">
                                    <img th:src="@{${tripFile.introIMG}}" alt="Intro Image">
                                </div>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" data-toggle="tab" href="#tabs-3" role="tab">
                                <div class="product__thumb__pic set-bg">
                                    <img th:src="@{${tripFile.routeIMG}}" alt="Route Image">
                                </div>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" data-toggle="tab" href="#tabs-4" role="tab">
                                <div class="product__thumb__pic set-bg">
                                    <img th:src="@{${tripFile.scheduleIMG}}" alt="Schedule Image">
                                </div>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" data-toggle="tab" href="#tabs-5" role="tab">
                                <div class="product__thumb__pic set-bg">
                                    <img th:src="@{${tripFile.detailIMG}}" alt="Detail Image">
                                </div>
                            </a>
                        </li>
                    </ul>
                </div>

                <div class="big_IMG">
                    <div class="tab-content">
                        <div class="tab-pane active" id="tabs-1" role="tabpanel">
                            <div class="product__details__pic__item">
                                <img th:src="@{${tripFile.mainIMG}}" alt="Main Image">
                            </div>
                        </div>
                        <div class="tab-pane" id="tabs-2" role="tabpanel">
                            <div class="product__details__pic__item">
                                <img th:src="@{${tripFile.introIMG}}" alt="Intro Image">
                            </div>
                        </div>
                        <div class="tab-pane" id="tabs-3" role="tabpanel">
                            <div class="product__details__pic__item">
                                <img th:src="@{${tripFile.routeIMG}}" alt="Route Image">
                            </div>
                        </div>
                        <div class="tab-pane" id="tabs-4" role="tabpanel">
                            <div class="product__details__pic__item">
                                <img th:src="@{${tripFile.scheduleIMG}}" alt="Schedule Image">
                            </div>
                        </div>
                        <div class="tab-pane" id="tabs-5" role="tabpanel">
                            <div class="product__details__pic__item">
                                <img th:src="@{${tripFile.detailIMG}}" alt="Detail Image">
                            </div>
                        </div>
                    </div>
                </div>

                <div class="col-lg-4 col-md-6" id="trip_checkbox">
                    <div class="checkout__order">
                        <h4 class="order__title" th:text="${trip.tripName}"></h4>
                        <h4 class="order__title">[<span th:text="${#strings.substring(trip.tripDate, 2, 4)} + '년' + ${#strings.substring(trip.tripDate, 5, 7)} + '월'+${#strings.substring(trip.tripDate, 8)} + '일 '+ '출발'"></span>
                            ]</h4>
                        <ul class="checkout__total__products">
                            <div class="multiselect">
                                <div class="selectBox" onclick="showCheckboxes()">
                                    <select>
                                        <option>옵션 선택</option>
                                    </select>
                                    <div class="overSelect"></div>
                                </div>
                                <div id="checkboxes">
                                    <div th:each="opt, status : ${options}">
                                        <label th:for="'product' + ${status.index}">
                                            <input type="checkbox" th:id="'product' + ${status.index}" th:data-price="${opt.optionPrice}" th:data-optionName="${opt.optionId}" onclick="calculateTotal()"/>
                                            <span th:text="${opt.optionName + ' (+₩' + opt.optionPrice div 10000 + '만)'}"></span>
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </ul>
                        <ul class="checkout__total__all">
                            <li>Option Price: ₩<span id="totalPrice">0</span></li>
                        </ul>
                        <div class="cart-btn">
                            <div class="cart-btn-detail1"><a href="#" class="site-btn">찜하기</a></div>
                            <div class="cart-btn-detail2"><a href="#" class="site-btn" id="Cart-btn" onclick="redirectToCart()">구매 하기</a></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
<!-- Shop Details Section End -->

<!-- Footer Section Begin -->

<!-- Footer Section End -->

<!-- Js Plugins -->
<script src="/js/mainpage/jquery-3.3.1.min.js"></script>
<script src="/js/mainpage/bootstrap.min.js"></script>
<!--<script src="js/mainpage/jquery.nicescroll.min.js"></script>-->
<!--<script src="js/mainpage/jquery.countdown.min.js"></script>-->
<!-- <script src="js/mainpage/mixitup.min.js"></script>-->
<script src="/js/mainpage/main.js"></script>

<!-- 옵션버튼.js -->
<script th:inline="javascript">
    var expanded = false;

    function showCheckboxes() {
        var checkboxes = document.getElementById("checkboxes");
        if (!expanded) {
            checkboxes.style.display = "inline-block";
            expanded = true;
        } else {
            checkboxes.style.display = "none";
            expanded = false;
        }
    }

    var checkboxes = document.querySelectorAll('input[type="checkbox"]');
    checkboxes.forEach(function (checkbox) {
        checkbox.addEventListener('change', function () {
            calculateTotal();
        });
    });

    function calculateTotal() {
        var totalPrice = 0;
        checkboxes.forEach(function (checkbox) {
            if (checkbox.checked) {
                totalPrice += parseFloat(checkbox.getAttribute('data-price'));
            }
        });
        document.getElementById('totalPrice').textContent = totalPrice;
    }

    function redirectToCart() {
        var selectedOptions = [];

        checkboxes.forEach(function (checkbox) {
            if (checkbox.checked) {
                selectedOptions.push(checkbox.getAttribute('data-optionName'));
            }
        });

        var tripNo = [[${tripNo}]];
        var cartNo = [[${cartTripNo}]];
        var check = [[${check}]];
        console.log("tripNo ="+tripNo);
        console.log("cartNo ="+cartNo);
        console.log("check ="+check);

        var redirectURL = "tripCart?selectedOptions=" + selectedOptions.join("-")+"&num=" + tripNo;
        if (parseInt(check) === 1) {
            if (parseInt(tripNo) !== parseInt(cartNo)) {
                alert("장바구니를 비워주세요.");
                redirectURL = "tripDetail?num=" + tripNo;
            } else {
                redirectURL = "tripCart?selectedOptions=" + selectedOptions.join("-")+"&num=" + tripNo;
            }
        }

        window.location.href = redirectURL;
    }
</script>
<!-- 옵션버튼 -->

</body>
</html>

