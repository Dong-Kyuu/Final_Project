<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.example.jhta_3team_finalproject.mybatis.mapper.User.UserMapper">

    <select id="getUserId">
        SELECT *
        FROM user
        WHERE user_id = #{userId}
    </select>

    <insert id="join">
        insert into user
        (user_num, user_id, user_password, user_name, user_email, user_phone_number, department_id, user_gender)
        values (#{userNum}, #{userId}, #{userPassword}, #{userName}, #{userEmail}, #{userPhoneNumber}, #{departmentId},
                #{userGender})
    </insert>


    <update id="userupdate">
        UPDATE user
        SET user_name            = #{userName},
            user_email           = #{userEmail},
            user_phone_number    = #{userPhoneNumber},
            user_gender          = #{userGender},
            user_profile_picture = #{userProfilePicture}
        WHERE user_num = #{userNum}
    </update>

    <!-- 사용자 정보 추가 -->
    <insert id="insert">
        insert into user
        (user_num, user_id, user_password, user_email, user_name, user_phone_number, department_id, position_id,
         user_gender, user_profile_picture, user_created_at, user_updated_at, user_auth)
        values (#{userNum}, #{userId}, #{userPassword}, #{userEmail}, #{userName}, #{userPhoneNumber}, #{departmentId},
                #{positionId}, #{userGender}, #{userProfilePicture}, NOW(), NOW(), #{userAuth})
    </insert>

    <select id="getListCount" resultType="int">  <!-- 페이징 -->
        select count(*) from user
    </select>


    <select id="getEmployee" resultType="User" parameterType="int">
        SELECT u.*, d.department_name AS departmentName, p.position_name AS positionName
        FROM user u
                 JOIN user_departments d ON u.department_id = d.department_id
                 JOIN user_positions p ON u.position_id = p.position_id
        WHERE u.user_num = #{userNum}
    </select>

</mapper>